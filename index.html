<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูุชุถุฎู ... ูุฑู ูู ุงูุฒูุงู </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* START: General Body Styles */
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #073B4C; /* Base background */
            color: #FFFFFF;
            padding-bottom: 100px; /* Add padding to body to prevent content from being hidden by fixed footer */
        }
        /* END: General Body Styles */

        /* START: Chart Container Styles */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; /* Limits max width on large screens */
            margin-left: auto;
            margin-right: auto;
            height: 250px; /* Default height for mobile */
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px; /* Larger height for desktop */
            }
        }
        /* END: Chart Container Styles */

        /* START: Card Styles */
        .card {
            background-color: #118AB2;
            border-radius: 1rem;
            padding: 1rem; /* Adjusted padding for mobile */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease-in-out;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        /* END: Card Styles */

        /* START: Highlight Colors */
        .highlight-yellow {
            color: #FFD166;
        }
        .highlight-red {
            color: #FF6B6B;
        }
        .highlight-green {
            color: #06D6A0;
        }
        /* END: Highlight Colors */

        /* START: Timeline Styles */
        .timeline {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center; /* Center the vertical line */
            width: 100%;
            padding-top: 20px;
            padding-bottom: 20px;
        }
        .timeline::before {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            left: 50%; /* Center the line */
            width: 4px;
            background-color: #118AB2;
            transform: translateX(-50%); /* Adjust for line width */
        }
        .timeline-item {
            position: relative;
            width: 100%; /* Full width on mobile, will be split on desktop */
            margin-bottom: 30px; /* Space between items */
            display: flex; /* Use flexbox for content and icon alignment */
        }
        .timeline-item:last-child {
            margin-bottom: 0;
        }
        /* Mobile-first: Default to right-aligned content */
        .timeline-item .timeline-content {
            background-color: #073B4C;
            border: 2px solid #118AB2;
            padding: 15px;
            border-radius: 10px;
            flex-grow: 1;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-right: 60px; /* Space for icon on the right */
            text-align: right; /* RTL alignment */
        }
        .timeline-item .timeline-icon {
            position: absolute;
            top: 0; /* Align icon to top of content */
            right: 0; /* Position icon on the right for RTL */
            width: 40px;
            height: 40px;
            background-color: #FFD166;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: #073B4C;
            z-index: 10;
            transform: translateX(50%); /* Center icon on the line */
        }

        /* Desktop specific styles for alternating timeline */
        @media (min-width: 768px) {
            .timeline-item {
                width: 50%; /* Each item takes half width */
                margin-bottom: 40px;
            }
            .timeline-item:nth-child(odd) {
                /* Items on the right side */
                align-self: flex-end; /* Push to the right */
                padding-right: 40px; /* Space for icon and line */
                padding-left: 0; /* Reset left padding */
                text-align: right;
            }
            .timeline-item:nth-child(even) {
                /* Items on the left side */
                align-self: flex-start; /* Push to the left */
                padding-left: 40px; /* Space for icon and line */
                padding-right: 0; /* Reset right padding */
                text-align: left;
            }
            .timeline-item:nth-child(odd) .timeline-content {
                margin-right: 0; /* Reset margin */
                margin-left: auto; /* Push content to right within its 50% width */
                text-align: right;
            }
            .timeline-item:nth-child(even) .timeline-content {
                margin-left: 0; /* Reset margin */
                margin-right: auto; /* Push content to left within its 50% width */
                text-align: left;
            }
            .timeline-item:nth-child(odd) .timeline-icon {
                right: -22px; /* Position icon on the line */
                left: auto; /* Ensure no left positioning */
                transform: translateY(-50%) translateX(0%); /* Center vertically on desktop */
            }
            .timeline-item:nth-child(even) .timeline-icon {
                left: -22px; /* Position icon on the line */
                right: auto; /* Ensure no right positioning */
                transform: translateY(-50%) translateX(0%); /* Center vertically on desktop */
            }
            .timeline-content h5 {
                font-size: 1.25rem; /* text-xl for desktop */
            }
            .timeline-content p {
                font-size: 1rem; /* text-base for desktop */
            }
        }
        /* END: Timeline Styles */

        /* START: Input Group Styles */
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        .input-group label {
            font-weight: bold;
            color: #FFD166;
        }
        .input-group input, .input-group select {
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid #118AB2;
            background-color: #FFFFFF; /* White background */
            color: #00008B; /* Dark blue text for maximum visibility */
            font-size: 1rem;
        }
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #FFD166;
            box-shadow: 0 0 0 2px rgba(255, 209, 102, 0.5);
        }
        /* END: Input Group Styles */

        /* START: Modal Styles */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 100; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.7); /* Black w/ opacity */
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #073B4C;
            margin: auto;
            padding: 2rem;
            border: 2px solid #118AB2;
            border-radius: 1rem;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            position: relative;
            text-align: center;
        }
        .close-button {
            color: #aaa;
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close-button:hover,
        .close-button:focus {
            color: #FFD166;
            text-decoration: none;
            cursor: pointer;
        }
        .modal-button {
            background-color: #06D6A0;
            color: #073B4C;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 1rem;
        }
        .modal-button:hover {
            background-color: #05B38B;
        }
        .loading-spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid #FFD166;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 1rem auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .hidden {
            display: none;
        }
        /* END: Modal Styles */

        /* START: Section Specific Backgrounds */
        #the-silent-thief {
            background-color: #0A4E60; /* Slightly lighter teal */
            padding: 2rem;
            border-radius: 1rem;
            margin-bottom: 2rem;
        }
        #the-secret-friend {
            background-color: #0A4E60; /* Changed to match #the-silent-thief */
            padding: 2rem;
            border-radius: 1rem;
            margin-bottom: 2rem;
        }
        #the-solution {
            background-color: #0A4E60; /* Changed to match #the-silent-thief */
            padding: 2rem;
            border-radius: 1rem;
            margin-bottom: 2rem;
        }
        /* END: Section Specific Backgrounds */

        /* START: Floating Buttons Container */
        .floating-buttons-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #073B4C; /* Match body background */
            padding: 1rem;
            box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.3);
            z-index: 50; /* Ensure it's above other content but below modals */
            display: flex;
            justify-content: center;
            gap: 1rem; /* Space between buttons */
            flex-wrap: wrap; /* Allow buttons to wrap on smaller screens */
        }
        .floating-buttons-container button {
            flex-grow: 1; /* Allow buttons to grow and fill space */
            max-width: 300px; /* Limit max width of each button */
        }
        @media (min-width: 768px) {
            .floating-buttons-container {
                padding: 1.5rem;
            }
            .floating-buttons-container button {
                flex-grow: 0; /* Don't grow on larger screens */
            }
        }
        /* END: Floating Buttons Container */
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8">

        <!-- START: Header Section -->
        <header class="text-center mb-8 md:mb-12">
            <h1 class="text-3xl md:text-6xl font-black highlight-yellow mb-2">๐ธ ุงุงูุฌููู ุงููุตุฑู: ุฑุญูุฉ ูุฑู</h1>
            <!-- Removed: <h2 class="text-xl md:text-4xl font-bold">ุขุฎุฑ ุชุญุฏูุซ ููุชุถุฎู ูู ูุตุฑ ูู 2016 - 2024</h2> -->
            <h2 class="text-xl md:text-4xl font-bold"></h2>
            <p class="text-base md:text-xl mt-4 max-w-3xl mx-auto text-gray-300">"ุงูุฌููู ูุด ุฏุงููโฆ ุงูุชุถุฎู ูู ุงููู ุฏุงูู!" ูู ุชุณุงุกูุช ูููุงู ุนู ูููุฉ "ุฌููู" ุฒูุงูุ ูู ูุฐุง ุงูุฅูููุฌุฑุงูููุ ููุดู ุฑุญูุฉ ุงูุฌููู ุงููุตุฑู ูุชุฃุซูุฑ ุงูุชุถุฎู ุนูููุ ูููู ุชุญูู ูุฏุฎุฑุงุชู ูู ุงูุถูุงุน!</p>
        </header>
        <!-- END: Header Section -->

        <main>
            <!-- START: Part 1 - The Silent Thief Section -->
            <section id="the-silent-thief" class="mb-12 md:mb-16">
                <h3 class="text-2xl md:text-4xl font-bold text-center mb-6 md:mb-8"><span class="highlight-red">ุงูุฌุฒุก ุงูุฃูู:</span> ุงููุงุฑ ุงููู ุจุชุญุฑู ูููุณู... ููู ุฃูู ุงูุชุถุฎู ุงูุฌููู!</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-8 mb-8 md:mb-12 text-center">
                    <div class="card">
                        <p class="text-4xl md:text-6xl font-black highlight-yellow">+39,000</p>
                        <p class="mt-1 text-sm md:text-lg">ุฌููู ูู ุงูููุฉ ุงูุดุฑุงุฆูุฉ ูู 100 ุฌููู ูู ุนุงู 1900 ุจุนููุฉ ุงูููู!</p>
                    </div>
                    <div class="card">
                        <p class="text-4xl md:text-6xl font-black highlight-yellow">+39,600%</p>
                        <p class="mt-1 text-sm md:text-lg">ูู ูุนุฏู ุงูุชุถุฎู ุงูุชุฑุงููู ุงูุชูุฑูุจู ููุฐ ุนุงู 1900.</p>
                    </div>
                    <div class="card">
                        <p class="text-4xl md:text-6xl font-black highlight-yellow">&gt;99%</p>
                        <p class="mt-1 text-sm md:text-lg">ุฎุณุงุฑุฉ ูู ุงูููุฉ ุงูุดุฑุงุฆูุฉ ููู ุงุญุชูุธ ุจูุฏุฎุฑุงุชู "ุชุญุช ุงูุจูุงุทุฉ".</p>
                    </div>
                </div>

                <div class="card mb-8 md:mb-12">
                    <h4 class="text-xl md:text-2xl font-bold mb-3 text-center">ุงูููุฉ ุงูุดุฑุงุฆูุฉ ููุจูุบ <span id="baseAmountDisplay">100</span> ุฌููู ูู ุณูุฉ <span id="startYearDisplay">1900</span> ุนุจุฑ ุงูุฒูู</h4>
                    <p class="text-center text-gray-300 text-sm md:text-base mb-4">ูุฐุง ุงูุฑุณู ููุถุญ ููู ุชุบูุฑุช ุงูููุฉ ุงูุดุฑุงุฆูุฉ ููุจูุบ <span id="baseAmountDisplay2">100</span> ุฌููู ูู ุณูุฉ <span id="startYearDisplay2">1900</span>ุ ููุง ูุนุงุฏูู ูู ูุจุงูุบ ูู ุงูุณููุงุช ุงููุงุญูุฉ ูุดุฑุงุก ููุณ ูููุฉ ุงูุณูุน ูุงูุฎุฏูุงุช ููุญูุงุธ ุนูู ููุณ ุงูููุฉ ุงูุดุฑุงุฆูุฉ.</p>
                    <div class="input-group max-w-xs mx-auto">
                        <label for="startYearInput" class="text-sm md:text-base">ุงุฎุชุฑ ุณูุฉ ุงูุจุฏุงูุฉ:</label>
                        <select id="startYearInput" class="w-full mb-4" aria-label="ุงุฎุชุฑ ุณูุฉ ุงูุจุฏุงูุฉ ููููุงุฑูุฉ">
                            <!-- Options will be dynamically populated by JavaScript -->
                        </select>
                        <label for="baseAmountInput" class="text-sm md:text-base">ุฃุฏุฎู ุงููุจูุบ ุงูุฃููู (ุฌููู):</label>
                        <input type="number" id="baseAmountInput" value="100" min="1" step="10" aria-label="ุฃุฏุฎู ุงููุจูุบ ุงูุฃููู ููุฌููู ุงููุตุฑู">
                    </div>
                    <div class="chart-container">
                        <canvas id="purchasingPowerChart"></canvas>
                    </div>
                </div>
                
                <div class="relative wrap overflow-hidden p-4 md:p-10 h-full">
                    <h4 class="text-2xl md:text-3xl font-bold mb-6 md:mb-8 text-center">ูุญุธุงุช ุงูุงูููุงุฑ ุงูุชุงุฑูุฎูุฉ</h4>
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-icon" role="img" aria-label="ุฃููููุฉ ูุจูู ุญูููู">๐๏ธ</div>
                            <div class="timeline-content">
                                <h5>1952: ุจุฏุงูุฉ ุงูุชุญูู</h5>
                                <p>ุจุนุฏ ุซูุฑุฉ ูููููุ ุจุฏุฃุช ุงูุฏููุฉ ุชุชุฏุฎู ูู ุงูุณูู ูุชุฏุนู ุงูุฃุณุนุงุฑุ ููุง ุฃุญุฏุซ ุฎููุงู ูู ุงูุชูุงุฒู ุงูุงูุชุตุงุฏู ุนูู ุงููุฏู ุงูุทููู.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-icon" role="img" aria-label="ุฃููููุฉ ุงููุฑุฉ ุงูุฃุฑุถูุฉ">๐</div>
                            <div class="timeline-content">
                                <h5>ุงูุณุจุนููุงุช (1970s): ููุฒุงุช ุณุนุฑูุฉ</h5>
                                <p>ุงูุงููุชุงุญ ุงูุงูุชุตุงุฏู ุงูุณุฑูุน ูุบูุฑ ุงูููุธู ุฃุฏู ุฅูู ููุฒุงุช ุณุนุฑูุฉ ููุงุฌุฆุฉ ููุจูุฑุฉ.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-icon" role="img" aria-label="ุฃููููุฉ ุณูู ุตุงุนุฏ">๐</div>
                            <div class="timeline-content">
                                <h5>ุงูุชุณุนููุงุช (1990s): ุงูุฎุตุฎุตุฉ</h5>
                                <p>ุจุฏุฃุช ุณูุงุณุงุช ุงูุฎุตุฎุตุฉุ ูุจุฏุฃ ุงูุฌููู ูุชุนููู ุฌุฒุฆููุง (ุชุญุฏูุฏ ุณุนุฑู ุญุณุจ ุงูุนุฑุถ ูุงูุทูุจ ุฌุฒุฆูุงู)ุ ููุง ุฃุซุฑ ุนูู ุงุณุชูุฑุงุฑู.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-icon" role="img" aria-label="ุฃููููุฉ ููุจุฑ ุตูุช">๐ฃ</div>
                            <div class="timeline-content">
                                <h5>2003: ุฅุดุงุฑุฉ ุงูุชุนููู</h5>
                                <p>ุจุฏุฃ ูุตุทูุญ "ุชุนููู ุงูุฌููู" ูุธูุฑ ุจููุฉ ูู ุงูููุงุดุงุช ุงูุงูุชุตุงุฏูุฉุ ููุง ุนูุณ ุชุฒุงูุฏ ุงูุถุบูุท ุนูู ุงูุนููุฉ.</p>
                            </div>
                        </div>
                         <div class="timeline-item">
                            <div class="timeline-icon" role="img" aria-label="ุฃููููุฉ ุจูู">๐ฆ</div>
                            <div class="timeline-content">
                                <h5>2016: ุงูุชุนููู ุงููุจูุฑ</h5>
                                <p>ุงูุชุนููู ุงูุฑุณูู ุงูุดุงูู ููุฌูููุ ููุง ุฃุฏู ูููุฒุฉ ุถุฎูุฉ ูู ุณุนุฑ ุงูุฏููุงุฑ ูุชุขูู ูุจูุฑ ูู ูููุฉ ุงูุนููุฉ.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-icon" role="img" aria-label="ุฃููููุฉ ุณูู ูุงุจุท">๐</div>
                            <div class="timeline-content">
                                <h5>2023: ูุฎ ุงูุฐุนุฑ</h5>
                                <p>ููุง ูู ุงููุงุณ ุฑุจุทุช ุณุนุฑ ุงูุตุฑู ุจุงูุชุถุฎูุ ูุจุฏุฃ ุงูุฏููุงุฑ ุงูุฑุณูู ุจู30 ุฌููู ููุทูุฑ ูู ุงูุณูู ุงูุณูุฏุงุก ูู40 ู 50 ู 60 ุฌูููโฆ ุญุตู ููุน ุญูููู! ุงููุงุณุ ุฎููุงู ุนูู ูุฏุฎุฑุงุชูุงุ ุงุดุชุฑุช ุฃู ุญุงุฌุฉ ุชุญุงูุธ ุนูู ูููุชูุงุ ููููู ุงููู ุงุดุชุฑู ุฏููุงุฑ ุนูู 60 ุฌููู. ูููุฃุณูุ ููุง ุชู ุชุฎููุถ ุงูุฌููู ูู ุงูุจูู ูุจูู ุนูู 50 ุฌูููุ ุงููู ุงุดุชุฑูุง ุนูู ุณุนุฑ ุงูู60 "ูุจุณูุง ูู ุงูุญูุทุฉ" ูุฎุณุฑูุง ุฌุฒุก ูู ูููุณููุ ููุจููุด ุนุงุฑููู ูุชุตุฑููุง ููุง ูุจูุนูุง ุงููู ุงุดุชุฑูู. ุฏู ุจูุฃูุฏ ุฅู ูุฑุงุฑุงุช ุงูุฐุนุฑ ุงููุงูู ุบุงูุจุงู ูุง ุชููู ูุฎุงู.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-icon" role="img" aria-label="ุฃููููุฉ ุณูู ูุฃุณูู">โฌ๏ธ</div>
                            <div class="timeline-content">
                                <h5>ููููู 2025: ุจุฏุงูุฉ ุงูุงูููุงุด ูุชุฃุฌูู ุงูุดุฑุงุก</h5>
                                <p>ุจุนุฏ ููุฌุงุช ุงูุชุถุฎู ุงูุนุงููุฉุ ุดูุฏ ุดูุฑ ููููู 2025 ุชุถุฎูุงู ุดูุฑูุงู ุณูุจูุงู ูุฃูู ูุฑุฉ ููุฐ ุฃูุซุฑ ูู ุนุงูุ ููุง ุฃุฏู ุฅูู ุงูุฎูุงุถ ุฃุณุนุงุฑ ุจุนุถ ุงูุณูุน ุจุดูู ููุญูุธ. ูุฐู ุงูุธุงูุฑุฉุ ุงููุนุฑููุฉ ุจุงูุงูููุงุดุ ุฏูุนุช ุงููุณุชููููู ุฅูู ุชุฃุฌูู ูุฑุงุฑุงุช ุงูุดุฑุงุกุ ุฎููุงู ูู ุงุณุชูุฑุงุฑ ุชุฑุงุฌุน ุงูุฃุณุนุงุฑุ ููุง ูุฏ ูุคุฏู ุฅูู ุชุจุงุทุค ุงูุชุตุงุฏู.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- END: Part 1 - The Silent Thief Section -->

            <!-- START: Part 2 - The Secret Friend Section -->
            <section id="the-secret-friend" class="mb-12 md:mb-16">
                <h3 class="text-2xl md:text-4xl font-bold text-center mb-6 md:mb-8"><span class="highlight-green">ุงูุฌุฒุก ุงูุซุงูู:</span> ุงูุตุฏูู ุงูุณุฑู... ููุงุฆุฏ ุงูุชุถุฎู ุงููุนุชุฏู!</h3>
                <p class="text-center max-w-3xl mx-auto mb-8 text-gray-300 text-sm md:text-base">ููุงุฌุฃุฉ! ุงูุชุถุฎู ููุณ ุฏุงุฆูุงู ุดุฑูุฑุงู. ุนูุฏูุง ูููู ูุนุชุฏูุงู ููุณูุทุฑูุง ุนููู (2-3% ุณูููุงู)ุ ูููู ุฃู ูููู ูููุฏุงู ููุงูุชุตุงุฏ. **"ุงูุชุถุฎู ุนุงูู ุฒู ุงูููุญ ูู ุงูุฃููโฆ ุฑุดุฉ ุจุณูุทุฉ ุชูุชุญ ุงูููุณ. ุฅููุง ูุชูุฑุ ูุฎููู ุชุฑูู ุงูุทุจู ููู!"**</p>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-8">
                    <div class="card text-center">
                         <p class="text-4xl mb-3">๐</p>
                        <h4 class="font-bold text-lg md:text-xl mb-2 highlight-yellow">ูุญูุฒ ุงูุฅููุงู</h4>
                        <p class="text-gray-200 text-sm md:text-base">ูุดุฌุน ุงููุงุณ ุนูู ุงูุดุฑุงุก ูุงูุงุณุชุซูุงุฑ ุจุฏูุงู ูู ุชุฎุฒูู ุงูุฃููุงู ุงูุชู ุชูู ูููุชูุงุ ููุง ูุญุฑู ุนุฌูุฉ ุงูุงูุชุตุงุฏ.</p>
                    </div>
                    <div class="card text-center">
                         <p class="text-4xl mb-3">๐ค</p>
                        <h4 class="font-bold text-lg md:text-xl mb-2 highlight-yellow">ูุณูู ุชุนุฏูู ุงูุฃุฌูุฑ</h4>
                        <p class="text-gray-200 text-sm md:text-base">ูููุญ ุงูุดุฑูุงุช ูุฑููุฉ ูุชุนุฏูู ุชูุงููููุง ูุฃุฌูุฑูุง ุจุดูู ุชุฏุฑูุฌู ูุณูุณ ุฏูู ุงูุญุงุฌุฉ ูุฎูุถ ุงูุฑูุงุชุจ ุจุดูู ูุจุงุดุฑ.</p>
                    </div>
                    <div class="card text-center">
                         <p class="text-4xl mb-3">โ๏ธ</p>
                        <h4 class="font-bold text-lg md:text-xl mb-2 highlight-yellow">ูุฎูู ุนุจุก ุงูุฏููู</h4>
                        <p class="text-gray-200 text-sm md:text-base">ูููู ุงููููุฉ ุงูุญููููุฉ ููุฏููู ุจูุฑูุฑ ุงูููุชุ ููุง ูุณูู ุนูู ุงูุฃูุฑุงุฏ ูุงูุญูููุงุช ุณุฏุงุฏ ูุฑูุถูู.</p>
                    </div>
                    <div class="card text-center">
                         <p class="text-4xl mb-3">โ๏ธ</p>
                        <h4 class="font-bold text-lg md:text-xl mb-2 highlight-yellow">ูุนุทู ูุณุงุญุฉ ููููุงูุฑุฉ</h4>
                        <p class="text-gray-200 text-sm md:text-base">ูููุญ ุงูุจูู ุงููุฑูุฒู ุงููุฏุฑุฉ ุนูู ุฎูุถ ุฃุณุนุงุฑ ุงููุงุฆุฏุฉ ุจุดูู ูุนุงู ูุชุญููุฒ ุงูุงูุชุตุงุฏ ูู ุฃููุงุช ุงูุฑููุฏ.</p>
                    </div>
                </div>
            </section>
            <!-- END: Part 2 - The Secret Friend Section -->

            <!-- START: Part 3 - The Solution Section -->
            <section id="the-solution" class="mb-12 md:mb-16">
                <h3 class="text-2xl md:text-4xl font-bold text-center mb-6 md:mb-8"><span class="highlight-yellow">ุงูุฌุฒุก ุงูุซุงูุซ:</span> ููู ุชุญูู ูุฏุฎุฑุงุชู ูู ุงูุฐูุจุงูุ</h3>
                <p class="text-center max-w-3xl mx-auto mb-8 text-gray-300 text-sm md:text-base">ุงูุฎูุงุตุฉ ุจุณูุทุฉ: "ุงุฌุนู ูููุณู ุชุฌุฑู ุฃุณุฑุน ูู ุงูุชุถุฎู!". ุงูุงุญุชูุงุธ ุจุงููููุฏ ูุงุด ูู ุฃูุจุฑ ุฎุณุงุฑุฉ. ุฅููู ููู ุชุญูู ููุณู:</p>

                <div class="card mb-8 md:mb-12">
                    <h4 class="text-xl md:text-2xl font-bold mb-3 text-center">ููุงุฑูุฉ ุตุงุฏูุฉ: 10,000 ุฌููู ูู ุนุงู 2000</h4>
                     <p class="text-center text-gray-300 text-sm md:text-base mb-4">ูุฐุง ุงูุฑุณู ููุถุญ ุงููุฑู ุงููุงุฆู ุจูู ุงูุงุญุชูุงุธ ุจูุจูุบ 10,000 ุฌููู "ุชุญุช ุงูุจูุงุทุฉ" ูุงุณุชุซูุงุฑู ูู ุงูุฐูุจ ููุฐ ุนุงู 2000 ูุญุชู ุงูููู (ููููู 2025). ูุงุญุธ ุฃู ุงููููุฉ ุงูููุฏูุฉ ูููุจูุบ ุชุนูุณ ููุชู ุงูุดุฑุงุฆูุฉ ุงููุชุขููุฉ ุจูุงุกู ุนูู ุจูุงูุงุช ุงูุชุถุฎูุ ุจูููุง ูู ุงุณุชุซูุฑ ูู ุงูุฐูุจ ููุงูุช ูููุชู ุงูููู ุญูุงูู **1.7 ููููู ุฌููู**!</p>
                    <div class="chart-container">
                        <canvas id="investmentChart"></canvas>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-8">
                    <div class="card text-center">
                         <p class="text-4xl mb-3">๐ฅ</p>
                        <h4 class="font-bold text-lg md:text-xl mb-2 highlight-yellow">ุงูุฐูุจ</h4>
                        <p class="text-gray-200 text-sm md:text-base">ููุงุฐ ุขูู ุชุงุฑูุฎู ูุญุชูุธ ุจูููุชู ุนูู ุงููุฏู ุงูุทููู ููุชููู ุนูู ุงูุชุถุฎู ูู ูุซูุฑ ูู ุงูุฃุญูุงู.</p>
                    </div>
                     <div class="card text-center">
                         <p class="text-4xl mb-3">๐ต</p>
                        <h4 class="font-bold text-lg md:text-xl mb-2 highlight-yellow">ุงูุนููุงุช ุงููุณุชูุฑุฉ</h4>
                        <p class="text-gray-200 text-sm md:text-base">ุชูููุน ุงููุฏุฎุฑุงุช ุจุนููุงุช ุฃุฌูุจูุฉ ูููุฉ ูุซู ุงูุฏููุงุฑ ูููู ูู ูุฎุงุทุฑ ุชุขูู ูููุฉ ุงูุนููุฉ ุงููุญููุฉ.</p>
                    </div>
                     <div class="card text-center">
                         <p class="text-4xl mb-3">๐</p>
                        <h4 class="font-bold text-lg md:text-xl mb-2 highlight-yellow">ุงูุฃุตูู ุงููุงููุฉ</h4>
                        <p class="text-gray-200 text-sm md:text-base">ุงูุงุณุชุซูุงุฑ ูู ุงูุนูุงุฑุงุชุ ุงูุฃุณููุ ุฃู ุดูุงุฏุงุช ุงูุงุณุชุซูุงุฑ ุฐุงุช ุงูุนุงุฆุฏ ุงูุญูููู ุงููุฑุชูุน.</p>
                    </div>
                    <div class="card text-center">
                         <p class="text-4xl mb-3">๐ง</p>
                        <h4 class="font-bold text-lg md:text-xl mb-2 highlight-yellow">ุงุณุชุซูุฑ ูู ููุณู</h4>
                        <p class="text-gray-200 text-sm md:text-base">ุงูุชุณุงุจ ููุงุฑุงุช ุฌุฏูุฏุฉ ุฃู ุงูุนูู ูู ูุฌุงูุงุช ุชุฏุฑ ุฏุฎูุงู ุจุงูุนููุฉ ุงูุตุนุจุฉ ูู ุฃููู ุงุณุชุซูุงุฑ.</p>
                    </div>
                </div>

                <!-- START: Summary Section -->
                <div class="card mt-8 mb-8 md:mb-12 text-center">
                    <h4 class="text-xl md:text-2xl font-bold highlight-yellow mb-3">ุงูุฎูุงุตุฉ: ุงููุนู ุงููุงูู ูู ุฏุฑุนู ุงูุฃููู!</h4>
                    <p class="max-w-3xl mx-auto text-gray-300 text-sm md:text-base">ุงูุฌููู ุงููุตุฑู ูุฑ ุจุฑุญูุฉ ูุคููุฉ. ูู ุชุนูู ูู ุงูุชุงุฑูุฎุ ุนุฑู ุฃู ุงููููุฉ ููุณุช ูู ุนุฏุฏ ุงูุฌูููุงุชุ ุจู ูู ููุชูุง ุงูุดุฑุงุฆูุฉ. ูููู ููุชุถุฎู ูู ุฏุฑุนู ูุชุญุงูุธ ุนูู ุชุนุจู ูุดุบูู. ุชุฐูุฑ ุฏุงุฆูุงู: "ูููุณู ูุฌุจ ุฃู ุชุนูู ุฃูุซุฑ ูููโฆ ูุฅุฐุง ุจููุช ูุงุฆูุฉ ูู ุญุณุงุจ ุจุนุงุฆุฏ 10% ุจูููุง ุงูุชุถุฎู 30%ุ ูุฃูุช ุชุฎุณุฑ 20% ูู ุณูุฉ ุฏูู ุฃู ุชุฏุฑู ุฐูู!"</p>
                </div>
                <!-- END: Summary Section -->
                
            </section>
            <!-- END: Part 3 - The Solution Section -->
        </main>

        <!-- START: Inflation Rate Section (Moved to the end) -->
        <section class="mb-12 md:mb-16">
            <div class="card p-4 mb-8 text-center">
                <p class="text-xl md:text-2xl font-bold highlight-yellow mb-2">ูุนุฏู ุงูุชุถุฎู ุงูุณููู:</p>
                <p id="currentInflationDate" class="text-lg md:text-xl font-bold text-gray-300 mb-2">ุขุฎุฑ ุชุญุฏูุซ: <span id="dynamicUpdateDate">ููููู 2025</span></p>
                <div class="flex items-center justify-center gap-2">
                    <span id="inflationRateDisplay" class="text-2xl md:text-4xl font-black highlight-green">14.9</span>
                    <span class="text-2xl md:text-4xl font-black highlight-green">%</span>
                </div>
                <p class="text-sm text-gray-400 mt-2">
                    <span class="highlight-yellow">ููุงุญุธุฉ ูุงูุฉ:</span> ูุฐุง ุงูุฑูู (14.9%) ูู ูุนุฏู ุชุถุฎู ุชูุถูุญู ููููุฐุฌ ุงูุจูุงูุงุชุ ููุฏ ูุง ูุนูุณ ุขุฎุฑ ุชุญุฏูุซ ุฑุณูู. ููุญุตูู ุนูู ุฃุญุฏุซ ูุฃุฏู ุจูุงูุงุช ุงูุชุถุฎูุ ูุฑุฌู ุงูุฑุฌูุน ูููุตุงุฏุฑ ุงูุฑุณููุฉ (ูุซู ุงูุฌูุงุฒ ุงููุฑูุฒู ููุชุนุจุฆุฉ ุงูุนุงูุฉ ูุงูุฅุญุตุงุก ุฃู ุงูุจูู ุงููุฑูุฒู ุงููุตุฑู).
                </p>
            </div>
        </section>
        <!-- END: Inflation Rate Section -->

        <!-- START: Footer Section -->
        <footer class="text-center mt-12 md:mt-16 border-t-2 border-blue-800 pt-6 md:pt-8">
            <p class="text-sm mt-4 text-gray-400">ุชุตููู ูุฅุนุฏุงุฏ ุจูุงุณุทุฉ: <span class="highlight-yellow">EcoVisionX</span></p>
            <div class="mt-4">
                <h5 class="text-xl font-bold highlight-yellow mb-2">ุชูุงุตู ูุนูุง ููุญุตูู ุนูู ูุตูุญุฉ ุงุณุชุซูุงุฑูุฉ ูุฎุตุตุฉ!</h5>
                <p class="text-base text-gray-300">
                    ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: <a href="mailto:info@ecovisionx.com" class="text-green-400 hover:underline">info@ecovisionx.com</a><br>
                    <a href="https://wa.me/201044141005" class="text-green-400 hover:underline">+20 104 414 1005</a>
                </p>
            </div>
        </footer>
        <!-- END: Footer Section -->

    </div>

    <!-- START: Floating Buttons Container -->
    <div class="floating-buttons-container">
        <button id="openInvestmentAdviceModal" class="bg-yellow-500 hover:bg-yellow-600 text-blue-900 font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 ease-in-out" aria-label="ุงูุชุญ ูุงูุฐุฉ ูุตูุญุฉ ุงุณุชุซูุงุฑูุฉ ูุฎุตุตุฉ">
            โจ ุงุญุตู ุนูู ูุตูุญุฉ ุงุณุชุซูุงุฑูุฉ ูุฎุตุตุฉ
        </button>
        <button id="openCertificateComparisonModal" class="bg-green-500 hover:bg-green-600 text-blue-900 font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 ease-in-out" aria-label="ุงูุชุญ ูุงูุฐุฉ ููุงุฑูุฉ ุงูุนูุงุฆุฏ ุงูุงุณุชุซูุงุฑูุฉ">
            ๐ ูุงุฑู ุงูุนูุงุฆุฏ ุงูุงุณุชุซูุงุฑูุฉ
        </button>
        <button id="openLoanCalculatorModal" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 ease-in-out" aria-label="ุงูุชุญ ูุงูุฐุฉ ุญุงุณุจุฉ ุงููุฑูุถ ุจุถูุงู ุงูุดูุงุฏุฉ">
            ๐ฆ ุญุงุณุจุฉ ุงููุฑูุถ ุจุถูุงู ุงูุดูุงุฏุฉ
        </button>
    </div>
    <!-- END: Floating Buttons Container -->

    <!-- START: Investment Advice Modal -->
    <div id="investmentAdviceModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeModalButton" aria-label="ุฅุบูุงู ูุงูุฐุฉ ูุตูุญุฉ ุงุณุชุซูุงุฑูุฉ">&times;</span>
            <h3 class="text-2xl font-bold mb-4 highlight-yellow">ูุตูุญุฉ ุงุณุชุซูุงุฑูุฉ ูุฎุตุตุฉ</h3>
            
            <div class="input-group mb-4 text-right">
                <label for="riskTolerance" class="mb-2">ุชุญูู ุงููุฎุงุทุฑ:</label>
                <select id="riskTolerance" class="w-full" aria-label="ุงุฎุชุฑ ูุณุชูู ุชุญูู ุงููุฎุงุทุฑ">
                    <option value="ููุฎูุถ ุฌุฏุงู">ููุฎูุถ ุฌุฏุงู</option>
                    <option value="ููุฎูุถ">ููุฎูุถ</option>
                    <option value="ูุชูุณุท" selected>ูุชูุณุท</option>
                    <option value="ูุฑุชูุน">ูุฑุชูุน</option>
                    <option value="ูุฑุชูุน ุฌุฏุงู">ูุฑุชูุน ุฌุฏุงู</option>
                </select>
            </div>
            
            <div class="input-group mb-4 text-right">
                <label for="investmentHorizon" class="mb-2">ุงูุฃูู ุงูุงุณุชุซูุงุฑู:</label>
                <select id="investmentHorizon" class="w-full" aria-label="ุงุฎุชุฑ ุงูุฃูู ุงูุงุณุชุซูุงุฑู">
                    <option value="ุฃูู ูู ุณูุฉ">ุฃูู ูู ุณูุฉ</option>
                    <option value="1-3 ุณููุงุช">1-3 ุณููุงุช</option>
                    <option value="3-5 ุณููุงุช" selected>3-5 ุณููุงุช</option>
                    <option value="ุฃูุซุฑ ูู 5 ุณููุงุช">ุฃูุซุฑ ูู 5 ุณููุงุช</option>
                </select>
            </div>

            <button id="getAdviceButton" class="modal-button" aria-label="ุงุญุตู ุนูู ุงููุตูุญุฉ ุงูุงุณุชุซูุงุฑูุฉ">
                ุงุญุตู ุนูู ุงููุตูุญุฉ โจ
            </button>

            <div id="adviceResult" class="mt-6 text-right text-gray-200 text-base">
                <!-- LLM advice will be displayed here -->
            </div>
            <div id="loadingSpinner" class="loading-spinner hidden" role="status" aria-label="ุฌุงุฑู ุชุญููู ุงููุตูุญุฉ"></div>
        </div>
    </div>
    <!-- END: Investment Advice Modal -->

    <!-- START: Certificate Comparison Modal -->
    <div id="certificateComparisonModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeCertificateComparisonModalButton" aria-label="ุฅุบูุงู ูุงูุฐุฉ ููุงุฑูุฉ ุงูุดูุงุฏุงุช">&times;</span>
            <h3 class="text-2xl font-bold mb-4 highlight-yellow">๐ ููุงุฑูุฉ ุนูุงุฆุฏ ุงูุดูุงุฏุงุช (3 ุณููุงุช)</h3>
            
            <p class="text-gray-300 text-sm mb-4">ูุงุฑู ุจูู ุณููุงุฑููููู ููุดูุงุฏุงุช ุงูุงุณุชุซูุงุฑูุฉ ุนูู ูุฏุงุฑ 3 ุณููุงุช.</p>

            <div id="certificateComparisonSection">
                <div class="input-group mb-4 text-right">
                    <label for="initialAmountComparison" class="mb-2">ุงููุจูุบ ุงูุฃููู (ุฌููู):</label>
                    <input type="number" id="initialAmountComparison" value="100000" min="100" step="1000" aria-label="ุฃุฏุฎู ุงููุจูุบ ุงูุฃููู ูููุงุฑูุฉ ุงูุดูุงุฏุงุช">
                </div>

                <h4 class="text-xl font-bold mb-3 highlight-green text-right">ุงูุณููุงุฑูู ุงูุฃูู: ูุงุฆุฏุฉ ุณูููุฉ ูุจุงุดุฑุฉ (ุชุตุฑู ุขุฎุฑ ุงูุณูุฉ)</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="input-group mb-2 text-right">
                        <label for="annualDirectRateYear1" class="mb-1">ุงูุณูุฉ ุงูุฃููู (%):</label>
                        <input type="number" id="annualDirectRateYear1" value="27" min="0" step="0.1" aria-label="ุฃุฏุฎู ูุณุจุฉ ุงููุงุฆุฏุฉ ุงูุณูููุฉ ุงููุจุงุดุฑุฉ ููุณูุฉ ุงูุฃููู">
                    </div>
                    <div class="input-group mb-2 text-right">
                        <label for="annualDirectRateYear2" class="mb-1">ุงูุณูุฉ ุงูุซุงููุฉ (%):</label>
                        <input type="number" id="annualDirectRateYear2" value="24" min="0" step="0.1" aria-label="ุฃุฏุฎู ูุณุจุฉ ุงููุงุฆุฏุฉ ุงูุณูููุฉ ุงููุจุงุดุฑุฉ ููุณูุฉ ุงูุซุงููุฉ">
                    </div>
                    <div class="input-group mb-4 text-right">
                        <label for="annualDirectRateYear3" class="mb-1">ุงูุณูุฉ ุงูุซุงูุซุฉ (%):</label>
                        <input type="number" id="annualDirectRateYear3" value="22" min="0" step="0.1" aria-label="ุฃุฏุฎู ูุณุจุฉ ุงููุงุฆุฏุฉ ุงูุณูููุฉ ุงููุจุงุดุฑุฉ ููุณูุฉ ุงูุซุงูุซุฉ">
                    </div>
                    <div class="input-group mb-4 text-right">
                        <label for="payoutFrequencyScenario1" class="mb-2">ูุชูุฑุฉ ุตุฑู ุงููุงุฆุฏุฉ (ุงูุณููุงุฑูู ุงูุฃูู):</label>
                        <select id="payoutFrequencyScenario1" class="w-full" aria-label="ุงุฎุชุฑ ูุชูุฑุฉ ุตุฑู ุงููุงุฆุฏุฉ ููุณููุงุฑูู ุงูุฃูู">
                            <option value="annually">ุณููู</option>
                            <option value="semiannually">ูุตู ุณููู</option>
                            <option value="quarterly">ุฑุจุน ุณููู</option>
                            <option value="monthly">ุดูุฑู</option>
                        </select>
                    </div>
                </div>

                <h4 class="text-xl font-bold mb-3 highlight-green text-right">ุงูุณููุงุฑูู ุงูุซุงูู: ูุงุฆุฏุฉ ุฏูุฑูุฉ ูุน ุฅุนุงุฏุฉ ุงุณุชุซูุงุฑ</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="input-group mb-2 text-right">
                        <label for="periodicRateYear1" class="mb-1">ุงูุณูุฉ ุงูุฃููู (%):</label>
                        <input type="number" id="periodicRateYear1" value="24" min="0" step="0.1" aria-label="ุฃุฏุฎู ูุณุจุฉ ุงููุงุฆุฏุฉ ุงูุฏูุฑูุฉ ููุณูุฉ ุงูุฃููู">
                    </div>
                    <div class="input-group mb-2 text-right">
                        <label for="periodicRateYear2" class="mb-1">ุงูุณูุฉ ุงูุซุงููุฉ (%):</label>
                        <input type="number" id="periodicRate2" value="20" min="0" step="0.1" aria-label="ุฃุฏุฎู ูุณุจุฉ ุงููุงุฆุฏุฉ ุงูุฏูุฑูุฉ ููุณูุฉ ุงูุซุงููุฉ">
                    </div>
                    <div class="input-group mb-4 text-right">
                        <label for="periodicRateYear3" class="mb-1">ุงูุณูุฉ ุงูุซุงูุซุฉ (%):</label>
                        <input type="number" id="periodicRateYear3" value="18" min="0" step="0.1" aria-label="ุฃุฏุฎู ูุณุจุฉ ุงููุงุฆุฏุฉ ุงูุฏูุฑูุฉ ููุณูุฉ ุงูุซุงูุซุฉ">
                    </div>
                    <div class="input-group mb-4 text-right">
                        <label for="payoutFrequency" class="mb-2">ูุชูุฑุฉ ุตุฑู ุงููุงุฆุฏุฉ ุงูุฏูุฑูุฉ (ุงูุณููุงุฑูู ุงูุซุงูู):</label>
                        <select id="payoutFrequency" class="w-full" aria-label="ุงุฎุชุฑ ูุชูุฑุฉ ุตุฑู ุงููุงุฆุฏุฉ ุงูุฏูุฑูุฉ ููุณููุงุฑูู ุงูุซุงูู">
                            <option value="monthly">ุดูุฑู</option>
                            <option value="quarterly">ุฑุจุน ุณููู</option>
                            <option value="semiannually">ูุตู ุณููู</option>
                            <option value="annually">ุณููู</option> <!-- Added annually option here -->
                        </select>
                    </div>
                    <div class="input-group mb-4 text-right">
                        <label for="dailyReinvestmentRate" class="mb-1">ูุงุฆุฏุฉ ุฅุนุงุฏุฉ ุงูุงุณุชุซูุงุฑ ุงูููููุฉ (%):</label>
                        <input type="number" id="dailyReinvestmentRate" value="10" min="0" step="0.1" aria-label="ุฃุฏุฎู ูุณุจุฉ ูุงุฆุฏุฉ ุฅุนุงุฏุฉ ุงูุงุณุชุซูุงุฑ ุงูููููุฉ">
                    </div>
                </div>

                <button id="calculateCertificates" class="modal-button" aria-label="ุงุญุณุจ ุนูุงุฆุฏ ุงูุดูุงุฏุงุช">
                    ุงุญุณุจ ุนูุงุฆุฏ ุงูุดูุงุฏุงุช โจ
                </button>

                <div id="certificateComparisonResult" class="mt-6 text-right text-gray-200 text-base">
                    <!-- Certificate comparison results will be displayed here -->
                </div>
                <button onclick="shareResult()" id="share-btn" class="bg-yellow-500 hover:bg-yellow-600 text-blue-900 font-bold py-3 px-6 rounded-full shadow-xl transition duration-300 ease-in-out hidden mt-4" aria-label="ุดุงุฑู ุงููุชุงุฆุฌ ูุน ุงูุขุฎุฑูู">
                    &#x21E7; ุดุงุฑู ูุงูุตุญ ุบูุฑู!
                </button>
            </div>
            <div id="comparisonLoadingSpinner" class="loading-spinner hidden" role="status" aria-label="ุฌุงุฑู ุญุณุงุจ ููุงุฑูุฉ ุงูุดูุงุฏุงุช"></div>
        </div>
    </div>
    <!-- END: Certificate Comparison Modal -->

    <!-- START: Loan Calculator Modal -->
    <div id="loanCalculatorModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeLoanCalculatorModalButton" aria-label="ุฅุบูุงู ูุงูุฐุฉ ุญุงุณุจุฉ ุงููุฑูุถ">&times;</span>
            <h3 class="text-2xl font-bold mb-4 highlight-yellow">  ุญุงุณุจุฉ ุงููุฑูุถ ุจุถูุงู ุงูุดูุงุฏุฉ</h3>
            <p class="text-gray-300 text-sm mb-4">ุงุญุณุจ ูุถุน ุงููุฑุถ ุจุถูุงู ุดูุงุฏุชู. (ุชุฃูุฏ ูู ุญุณุงุจ ุนูุงุฆุฏ ุงูุดูุงุฏุงุช ุฃููุงู)</p>
            
            <div id="loanScenarioSection">
                <div class="input-group mb-4 text-right">
                    <label for="initialAmountLoan" class="mb-2">ุงููุจูุบ ุงูุฃููู ููุดูุงุฏุฉ (ุฌููู):</label>
                    <input type="number" id="initialAmountLoan" value="100000" min="100" step="1000" aria-label="ุฃุฏุฎู ุงููุจูุบ ุงูุฃููู ููุดูุงุฏุฉ ูุบุฑุถ ุงููุฑุถ">
                </div>
                <div class="input-group mb-4 text-right">
                    <label for="loanCertType" class="mb-2">ููุน ุงูุดูุงุฏุฉ ูููุฑุถ:</label>
                    <select id="loanCertType" class="w-full" aria-label="ุงุฎุชุฑ ููุน ุงูุดูุงุฏุฉ ูููุฑุถ">
                        <option value="scenario1">ุงูุณููุงุฑูู ุงูุฃูู (ูุงุฆุฏุฉ ุณูููุฉ ูุจุงุดุฑุฉ)</option>
                        <option value="scenario2">ุงูุณููุงุฑูู ุงูุซุงูู (ูุงุฆุฏุฉ ุฏูุฑูุฉ ูุน ุฅุนุงุฏุฉ ุงุณุชุซูุงุฑ)</option>
                    </select>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="input-group mb-2 text-right">
                        <label for="loanAnnualRate" class="mb-1">ูุงุฆุฏุฉ ุงููุฑุถ ุงูุณูููุฉ (%):</label>
                        <input type="number" id="loanAnnualRate" value="20" min="0" step="0.1" aria-label="ุฃุฏุฎู ูุณุจุฉ ูุงุฆุฏุฉ ุงููุฑุถ ุงูุณูููุฉ">
                    </div>
                    <div class="input-group mb-4 text-right">
                        <label for="loanDailyReinvestmentRate" class="mb-1">ูุงุฆุฏุฉ ุฅุนุงุฏุฉ ุงูุงุณุชุซูุงุฑ ุงูููููุฉ (%):</label>
                        <input type="number" id="loanDailyReinvestmentRate" value="10" min="0" step="0.1" aria-label="ุฃุฏุฎู ูุณุจุฉ ูุงุฆุฏุฉ ุฅุนุงุฏุฉ ุงูุงุณุชุซูุงุฑ ุงูููููุฉ ูููุฑุถ">
                    </div>
                </div>

                <button id="calculateLoanScenarioButton" class="modal-button" aria-label="ุงุญุณุจ ูุถุน ุงููุฑุถ">
                    ุงุญุณุจ ูุถุน ุงููุฑุถ ๐ฆ
                </button>

                <div id="loanScenarioResult" class="mt-6 text-right text-gray-200 text-base">
                    <!-- Loan scenario results and advice will be displayed here -->
                </div>
            </div>
            <div id="loanCalculatorLoadingSpinner" class="loading-spinner hidden" role="status" aria-label="ุฌุงุฑู ุญุณุงุจ ูุถุน ุงููุฑุถ"></div>
        </div>
    </div>
    <!-- END: Loan Calculator Modal -->

    <!-- START: JavaScript Section -->
    <script>
        // Helper function to wrap long labels for Chart.js
        const wrapLabel = (label) => {
            const maxLength = 16;
            if (typeof label !== 'string' || label.length <= maxLength) {
                return label;
            }
            const words = label.split(' ');
            const lines = [];
            let currentLine = '';
            words.forEach(word => {
                if ((currentLine + ' ' + word).length > maxLength) {
                    lines.push(currentLine);
                    currentLine = word;
                } else {
                    currentLine += (currentLine ? ' ' : '') + word;
                }
            });
            lines.push(currentLine);
            return lines;
        };

        // Helper function for Chart.js tooltip titles
        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            }
            return label;
        };
        
        let purchasingPowerChartInstance;
        let investmentChartInstance;

        // Global variables to store scenario results for loan calculation
        let scenario1CertData = { rates: [], payoutFrequency: '' };
        let scenario2CertData = { rates: [], payoutFrequency: '' };
        let finalAmountScenario1Global = 0;
        let finalAmountScenario2Global = 0;

        // Global variables to store fetched data
        let fetchedInflationFactors = {};
        let allYears = [];
        let fetchedInvestmentData = {};

        // Simulated API call for inflation data
        async function fetchInflationData() {
            return new Promise(resolve => {
                setTimeout(() => {
                    resolve({
                        '1900': 100,
                        '1952': 400,
                        '2000': 12000,
                        '2016': 15625,
                        '2020': 27000,
                        'ููููู 2025': 40000
                    });
                }, 500); // Reduced simulated network delay
            });
        }

        // Simulated API call for investment comparison data
        async function fetchInvestmentData() {
            return new Promise(resolve => {
                setTimeout(() => {
                    // These values are based on the infographic's narrative for 10,000 EGP in 2000
                    // 10,000 EGP in 2000 is worth 3000 EGP in 2025 purchasing power (based on 40000/12000 factor)
                    // 10,000 EGP in 2000 invested in gold is ~1,727,290 EGP today
                    resolve({
                        originalCashValue: 3000,
                        originalGoldValue: 1727290
                    });
                }, 750); // Reduced simulated network delay
            });
        }


        // Function to update the purchasing power chart based on user input
        const updatePurchasingPowerChart = (baseAmount, startYear) => {
            const startYearFactor = fetchedInflationFactors[startYear];
            if (!startYearFactor) {
                console.error("Invalid start year selected or data not loaded:", startYear);
                return;
            }

            const chartLabels = allYears.filter(year => {
                // Include all years from startYear onwards, and always include "ููููู 2025"
                const yearNum = parseInt(year);
                const startYearNum = parseInt(startYear);
                return yearNum >= startYearNum || year === 'ููููู 2025';
            }).sort((a, b) => {
                // Custom sort to handle "ููููู 2025" at the end
                if (a === 'ููููู 2025') return 1;
                if (b === 'ููููู 2025') return -1;
                return parseInt(a) - parseInt(b);
            });

            const scaledData = chartLabels.map(year => {
                const currentYearFactor = fetchedInflationFactors[year];
                const relativeFactor = currentYearFactor / startYearFactor;
                return baseAmount * relativeFactor;
            });

            purchasingPowerChartInstance.data.labels = chartLabels.map(wrapLabel);
            purchasingPowerChartInstance.data.datasets[0].data = scaledData;
            purchasingPowerChartInstance.update();

            document.getElementById('baseAmountDisplay').textContent = new Intl.NumberFormat('ar-EG').format(baseAmount);
            document.getElementById('baseAmountDisplay2').textContent = new Intl.NumberFormat('ar-EG').format(baseAmount);
            document.getElementById('startYearDisplay').textContent = startYear;
            document.getElementById('startYearDisplay2').textContent = startYear;
        };

        // Initialize charts and set up event listeners when the window loads
        window.onload = async function() {
            // Show a main loading spinner overlay
            const mainContent = document.querySelector('main');
            const header = document.querySelector('header');
            const footer = document.querySelector('footer');
            const floatingButtons = document.querySelector('.floating-buttons-container');
            const loadingOverlay = document.createElement('div');
            loadingOverlay.id = 'mainLoadingOverlay';
            loadingOverlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(7, 59, 76, 0.9); /* Dark blue with transparency */
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                flex-direction: column;
                color: white;
            `;
            loadingOverlay.innerHTML = `
                <div class="loading-spinner" role="status" aria-label="ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ"></div>
                <p class="mt-4 text-xl">ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช...</p>
            `;
            document.body.appendChild(loadingOverlay);

            // Hide main content initially
            if (mainContent) mainContent.style.display = 'none';
            if (header) header.style.display = 'none';
            if (footer) footer.style.display = 'none';
            if (floatingButtons) floatingButtons.style.display = 'none';

            try {
                // Fetch data
                fetchedInflationFactors = await fetchInflationData();
                allYears = Object.keys(fetchedInflationFactors); // Update allYears after fetching
                fetchedInvestmentData = await fetchInvestmentData();

                // Update current inflation date display dynamically
                // Removed dynamic update as per user request to keep it static for now
                // const dynamicUpdateDateElement = document.getElementById('dynamicUpdateDate');
                // if (dynamicUpdateDateElement) {
                //     const currentDate = new Date();
                //     const options = { month: 'long', year: 'numeric' };
                //     dynamicUpdateDateElement.textContent = currentDate.toLocaleDateString('ar-EG', options);
                // }

                // Populate startYearInput dropdown
                const startYearInputSelect = document.getElementById('startYearInput');
                // Clear existing options to prevent duplicates
                startYearInputSelect.innerHTML = ''; 
                allYears.forEach(year => {
                    if (year !== 'ููููู 2025') { // Do not allow "ููููู 2025" as a start year
                        const option = document.createElement('option');
                        option.value = year;
                        option.textContent = year;
                        startYearInputSelect.appendChild(option);
                    }
                });
                // Set default selected year if needed, or ensure the first option is selected
                startYearInputSelect.value = '1900'; // Default to 1900


                // Initialize Purchasing Power Chart
                const ctxPurchasingPower = document.getElementById('purchasingPowerChart').getContext('2d');
                if (ctxPurchasingPower) {
                    purchasingPowerChartInstance = new Chart(ctxPurchasingPower, {
                        type: 'line',
                        data: {
                            labels: [], // Will be populated dynamically
                            datasets: [{
                                label: 'ุงููุจูุบ ุงููุทููุจ (ุจุงูุฌููู)', /* Updated label */
                                data: [], // Will be populated dynamically
                                borderColor: '#FFD166',
                                backgroundColor: 'rgba(255, 209, 102, 0.2)',
                                fill: true,
                                tension: 0.1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'ุงููููุฉ ุจุงูุฌููู', /* Updated label */
                                        color: '#FFFFFF'
                                    },
                                    ticks: { color: '#FFFFFF' }
                                },
                                x: {
                                    ticks: { color: '#FFFFFF' }
                                }
                            },
                            plugins: {
                                legend: {
                                    labels: {
                                        color: '#FFFFFF'
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        title: tooltipTitleCallback
                                    }
                                }
                            }
                        }
                    });
                } else {
                    console.error('Failed to get context for purchasingPowerChart.');
                }

                // Initialize Investment Chart with fixed data
                const ctxInvestment = document.getElementById('investmentChart').getContext('2d');
                if (ctxInvestment) {
                    investmentChartInstance = new Chart(ctxInvestment, {
                        type: 'bar',
                        data: {
                            labels: ['ุงุฏุฎุงุฑ ููุฏู "ุชุญุช ุงูุจูุงุทุฉ"', 'ุงุณุชุซูุงุฑ ูู ุงูุฐูุจ'].map(wrapLabel),
                            // Directly use the fixed values from fetchedInvestmentData
                            datasets: [{
                                label: 'ุงููููุฉ ุงูููุงุฆูุฉ ูู 2025 (ุจุงูุฌููู)',
                                data: [fetchedInvestmentData.originalCashValue, fetchedInvestmentData.originalGoldValue], 
                                backgroundColor: ['#FF6B6B', '#06D6A0'],
                                borderColor: ['#FF6B6B', '#06D6A0'],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            indexAxis: 'y',
                            scales: {
                                x: {
                                    beginAtZero: true,
                                    type: 'logarithmic',
                                    title: {
                                        display: true,
                                        text: 'ุงููููุฉ ุจุงูุฌููู (ูููุงุณ ููุบุงุฑูุชูู)',
                                        color: '#FFFFFF'
                                    },
                                    ticks: { 
                                        color: '#FFFFFF',
                                        callback: function(value, index, values) {
                                            if (value === 1000000 || value === 100000 || value === 10000 || value === 1000 || value === 100 || value === 10) {
                                                return new Intl.NumberFormat('ar-EG').format(value) + ' ุฌููู';
                                            }
                                            return ''; 
                                        }
                                    }
                                }
                            },
                            y: {
                                ticks: { color: '#FFFFFF', font: { size: 14 } }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    title: tooltipTitleCallback,
                                    label: function(context) {
                                        let label = '';
                                        // Custom label for "ุงุฏุฎุงุฑ ููุฏู 'ุชุญุช ุงูุจูุงุทุฉ'"
                                        if (context.dataIndex === 0) { 
                                            label = 'ุงููููุฉ ุงูุฃุตููุฉ ูู 2000: 10,000 ุฌููู';
                                            label += '\nุงูููุฉ ุงูุดุฑุงุฆูุฉ ุงููุชุจููุฉ ูู ููููู 2025: ' + new Intl.NumberFormat('ar-EG', { style: 'currency', currency: 'EGP' }).format(context.parsed.x);
                                        } else { // For "ุงุณุชุซูุงุฑ ูู ุงูุฐูุจ"
                                            label = 'ุงููููุฉ ุงูุฃุตููุฉ ูู 2000: 10,000 ุฌููู';
                                            label += '\nุงููููุฉ ุงูุญุงููุฉ (ููููู 2025): ' + new Intl.NumberFormat('ar-EG', { style: 'currency', currency: 'EGP' }).format(context.parsed.x);
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    });
                } else {
                    console.error('Failed to get context for investmentChart.');
                }

                // Call initial updates for display spans
                const baseAmountInput = document.getElementById('baseAmountInput');
                
                // Add null checks for these elements as well, as they are accessed on load
                if (!baseAmountInput || !startYearInputSelect) { 
                    console.error("FATAL ERROR: Required input elements not found. Cannot initialize main charts."); 
                    return; 
                }

                // Initial update with default values
                updatePurchasingPowerChart(parseFloat(baseAmountInput.value), startYearInputSelect.value);

                // Event listeners for input fields
                baseAmountInput.addEventListener('input', (e) => {
                    const newAmount = parseFloat(e.target.value);
                    const selectedYear = startYearInputSelect.value;
                    if (!isNaN(newAmount) && newAmount > 0) {
                        updatePurchasingPowerChart(newAmount, selectedYear);
                    } else {
                        updatePurchasingPowerChart(0, selectedYear);
                    }
                });

                startYearInputSelect.addEventListener('change', (e) => {
                    const newYear = e.target.value;
                    const currentAmount = parseFloat(baseAmountInput.value);
                    if (!isNaN(currentAmount) && currentAmount > 0) {
                        updatePurchasingPowerChart(currentAmount, newYear);
                    } else {
                        updatePurchasingPowerChart(0, newYear);
                    }
                });


                // START: Gemini API Integration Logic for Investment Advice Modal
                const investmentAdviceModal = document.getElementById('investmentAdviceModal');
                const openInvestmentAdviceModalButton = document.getElementById('openInvestmentAdviceModal');
                const closeModalButton = document.getElementById('closeModalButton');
                const getAdviceButton = document.getElementById('getAdviceButton');
                const riskToleranceSelect = document.getElementById('riskTolerance');
                const investmentHorizonSelect = document.getElementById('investmentHorizon');
                const adviceResultDiv = document.getElementById('adviceResult');
                const loadingSpinner = document.getElementById('loadingSpinner');

                // Add null checks for these elements as well
                if (!investmentAdviceModal) { console.error("FATAL ERROR: Element with ID 'investmentAdviceModal' not found."); return; }
                if (!openInvestmentAdviceModalButton) { console.error("FATAL ERROR: Element with ID 'openInvestmentAdviceModal' not found."); return; }
                if (!closeModalButton) { console.error("FATAL ERROR: Element with ID 'closeModalButton' not found."); return; }
                if (!getAdviceButton) { console.error("FATAL ERROR: Element with ID 'getAdviceButton' not found."); return; }
                if (!riskToleranceSelect) { console.error("FATAL ERROR: Element with ID 'riskTolerance' not found."); return; }
                if (!investmentHorizonSelect) { console.error("FATAL ERROR: Element with ID 'investmentHorizon' not found."); return; }
                if (!adviceResultDiv) { console.error("FATAL ERROR: Element with ID 'adviceResult' not found."); return; }
                if (!loadingSpinner) { console.error("FATAL ERROR: Element with ID 'loadingSpinner' not found."); return; }


                openInvestmentAdviceModalButton.addEventListener('click', () => {
                    investmentAdviceModal.style.display = 'flex';
                    adviceResultDiv.innerHTML = ''; // Clear previous results
                });

                closeModalButton.addEventListener('click', () => {
                    investmentAdviceModal.style.display = 'none';
                });

                window.addEventListener('click', (event) => {
                    if (event.target == investmentAdviceModal) {
                        investmentAdviceModal.style.display = 'none';
                    }
                });

                getAdviceButton.addEventListener('click', async () => {
                    const riskTolerance = riskToleranceSelect.value;
                    const investmentHorizon = investmentHorizonSelect.value;

                    adviceResultDiv.innerHTML = ''; // Clear previous advice
                    loadingSpinner.classList.remove('hidden'); // Show loading spinner

                    const prompt = `ุจุตูุชู ูุณุชุดุงุฑูุง ูุงููุงู ูู ูุตุฑุ ูุฏู ูุตูุญุฉ ุงุณุชุซูุงุฑูุฉ ููุฌุฒุฉ ูุดุฎุต ูุฏูู ุชุญูู ูุฎุงุทุฑ ${riskTolerance} ูุฃูู ุงุณุชุซูุงุฑู ${investmentHorizon}. ุฑูุฒ ุนูู ุงูุฃุตูู ุงูุชู ุชุญูู ูู ุงูุชุถุฎู ูุชูุงุณุจ ุงูุณูู ุงููุตุฑู. ูุง ุชุฐูุฑ ุฃู ุฃุฑูุงู ุฃู ุนูุงุฆุฏ ูุญุฏุฏุฉ.`;

                    console.log('Sending prompt to Gemini API:', prompt); // Debugging: Log the prompt
                    // Log environment variables for debugging API key issue
                    console.log('__app_id:', typeof __app_id !== 'undefined' ? __app_id : 'undefined');
                    console.log('__firebase_config:', typeof __firebase_config !== 'undefined' ? __firebase_config : 'undefined');
                    console.log('__initial_auth_token:', typeof __initial_auth_token !== 'undefined' ? 'present' : 'undefined');


                    try {
                        let chatHistory = [];
                        chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                        const payload = { contents: chatHistory };
                        // The Canvas environment injects the API key automatically when this is an empty string.
                        // If you are running this file directly from your desktop, you will need to
                        // obtain your own Gemini API key and insert it here:
                        const apiKey = ""; // IMPORTANT: If running locally, replace with your actual Gemini API key, e.g., "YOUR_GEMINI_API_KEY_HERE"
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                        
                        // If apiKey is still empty here, it means it's running locally without a manually inserted key
                        // and the Canvas environment is not intercepting the fetch.
                        if (apiKey === "") {
                            adviceResultDiv.innerHTML = '<p class="text-red-400">ุฎุทุฃ ูู ููุชุงุญ API: ูุจุฏู ุฃูู ุชููู ุจุชุดุบูู ุงูููู ูุญููุงู. ูุฑุฌู ุงูุญุตูู ุนูู ููุชุงุญ Gemini API ุงูุฎุงุต ุจู ูุฅุฏุฎุงูู ูุฏููุงู ูู ุงูููุฏ (ุงุจุญุซ ุนู `const apiKey = "";` ูุงุณุชุจุฏููุง ุจููุชุงุญู).</p>';
                            console.error('API Key is missing. If running locally, please insert your Gemini API key into the `apiKey` variable in the code.');
                            loadingSpinner.classList.add('hidden');
                            return;
                        }

                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        
                        console.log('Gemini API response status:', response.status); // Debugging: Log response status
                        const result = await response.json();
                        console.log('Gemini API response data:', result); // Debugging: Log full response data
                        
                        if (response.ok && result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const text = result.candidates[0].content.parts[0].text;
                            adviceResultDiv.innerHTML = `<p>${text}</p>`;
                        } else {
                            let errorMessage = 'ุนุฐุฑุงูุ ูู ุฃุชููู ูู ุงูุญุตูู ุนูู ูุตูุญุฉ ุงุณุชุซูุงุฑูุฉ. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.';
                            if (result.error && result.error.message) {
                                errorMessage = `ุฎุทุฃ ูู API: ${result.error.message}. ูุฑุฌู ุงูุชุฃูุฏ ูู ุฃู ููุชุงุญ API ุตุญูุญ ุฃู ุงูุงุชุตุงู ุจุงูุฏุนู.`;
                            } else if (!response.ok) {
                                errorMessage = `ุฎุทุฃ ูู ุงูุดุจูุฉ ุฃู ุงูุฎุงุฏู: ุงูุญุงูุฉ ${response.status}. ูุฑุฌู ุงูุชุญูู ูู ุงุชุตุงูู ุจุงูุฅูุชุฑูุช.`;
                            }
                            console.error('Gemini API returned an error or unexpected structure:', result); // More detailed error logging
                            adviceResultDiv.innerHTML = `<p class="text-red-400">${errorMessage}</p>`;
                        }
                    } catch (error) {
                        console.error('Error calling Gemini API:', error); // Debugging: Log the actual error object
                        adviceResultDiv.innerHTML = '<p class="text-red-400">ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฌูุจ ุงููุตูุญุฉ ุงูุงุณุชุซูุงุฑูุฉ. ูุฑุฌู ุงูุชุญูู ูู ุงุชุตุงูู ุจุงูุฅูุชุฑูุช ูุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.</p>';
                        } finally {
                        loadingSpinner.classList.add('hidden'); // Hide loading spinner
                    }
                });
                // END: Gemini API Integration Logic for Investment Advice Modal

                // START: Certificate Comparison Modal Logic
                const certificateComparisonModal = document.getElementById('certificateComparisonModal');
                const openCertificateComparisonModalButton = document.getElementById('openCertificateComparisonModal');
                const closeCertificateComparisonModalButton = document.getElementById('closeCertificateComparisonModalButton');
                
                const certificateComparisonResultDiv = document.getElementById('certificateComparisonResult');
                const comparisonLoadingSpinner = document.getElementById('comparisonLoadingSpinner');
                const calculateCertificatesButton = document.getElementById('calculateCertificates');
                const shareButton = document.getElementById('share-btn');


                // Add null checks for these elements
                if (!certificateComparisonModal) { console.error("FATAL ERROR: Element with ID 'certificateComparisonModal' not found."); return; }
                if (!openCertificateComparisonModalButton) { console.error("FATAL ERROR: Element with ID 'openCertificateComparisonModal' not found."); return; }
                if (!closeCertificateComparisonModalButton) { console.error("FATAL ERROR: Element with ID 'closeCertificateComparisonModalButton' not found."); return; }
                if (!certificateComparisonResultDiv) { console.error("FATAL ERROR: Element with ID 'certificateComparisonResultDiv' not found."); return; }
                if (!comparisonLoadingSpinner) { console.error("FATAL ERROR: Element with ID 'comparisonLoadingSpinner' not found."); return; }
                if (!calculateCertificatesButton) { console.error("FATAL ERROR: Element with ID 'calculateCertificates' not found."); return; }
                if (!shareButton) { console.error("FATAL ERROR: Element with ID 'share-btn' not found."); return; }


                openCertificateComparisonModalButton.addEventListener('click', () => {
                    certificateComparisonModal.style.display = 'flex';
                    certificateComparisonResultDiv.innerHTML = ''; // Clear previous results
                    shareButton.classList.add('hidden'); // Hide share button when modal opens
                });

                closeCertificateComparisonModalButton.addEventListener('click', () => {
                    certificateComparisonModal.style.display = 'none';
                });

                window.addEventListener('click', (event) => {
                    if (event.target == certificateComparisonModal) {
                        certificateComparisonModal.style.display = 'none';
                    }
                });

                // Helper to get number of payouts per year based on frequency
                const getPayoutPeriodsPerYear = (frequency) => {
                    switch (frequency) {
                        case 'annually': return 1;
                        case 'semiannually': return 2;
                        case 'quarterly': return 4;
                        case 'monthly': return 12;
                        default: return 1; // Default to annually
                    }
                };

                // Helper to translate frequency to Arabic
                const translateFrequencyToArabic = (frequency) => {
                    switch (frequency) {
                        case 'annually': return 'ุณููู';
                        case 'semiannually': return 'ูุตู ุณููู';
                        case 'quarterly': return 'ุฑุจุน ุณููู';
                        case 'monthly': return 'ุดูุฑู';
                        default: return '';
                    }
                };

                // Function to calculate Scenario 1 and Scenario 2
                calculateCertificatesButton.addEventListener('click', () => {
                    console.log("Calculate Certificates button clicked.");
                    certificateComparisonResultDiv.innerHTML = '';
                    comparisonLoadingSpinner.classList.remove('hidden');
                    shareButton.classList.add('hidden'); // Hide share button during calculation


                    try {
                        const initialAmountComparisonInput = document.getElementById('initialAmountComparison');
                        if (!initialAmountComparisonInput) { throw new Error("Element with ID 'initialAmountComparison' not found."); }
                        
                        const annualDirectRateYear1Input = document.getElementById('annualDirectRateYear1');
                        if (!annualDirectRateYear1Input) { throw new Error("Element with ID 'annualDirectRateYear1' not found."); }
                        const annualDirectRateYear2Input = document.getElementById('annualDirectRateYear2');
                        if (!annualDirectRateYear2Input) { throw new Error("Element with ID 'annualDirectRateYear2' not found."); }
                        const annualDirectRateYear3Input = document.getElementById('annualDirectRateYear3');
                        // FIX: Corrected ID to match HTML
                        if (!annualDirectRateYear3Input) { throw new Error("Element with ID 'annualDirectRateYear3' not found."); } 
                        
                        const payoutFrequencyScenario1Select = document.getElementById('payoutFrequencyScenario1');
                        if (!payoutFrequencyScenario1Select) { throw new Error("Element with ID 'payoutFrequencyScenario1' not found."); }
                        
                        const periodicRateYear1Input = document.getElementById('periodicRateYear1');
                        if (!periodicRateYear1Input) { throw new Error("Element with ID 'periodicRateYear1' not found."); }
                        const periodicRateYear2Input = document.getElementById('periodicRate2'); // Correct ID here
                        if (!periodicRateYear2Input) { throw new Error("Element with ID 'periodicRate2' not found."); } // Correct variable name in check
                        const periodicRateYear3Input = document.getElementById('periodicRateYear3'); // FIX: Corrected ID to match HTML
                        if (!periodicRateYear3Input) { throw new Error("Element with ID 'periodicRateYear3' not found."); } // Correct variable name in check
                        
                        const payoutFrequencySelect = document.getElementById('payoutFrequency');
                        if (!payoutFrequencySelect) { throw new Error("Element with ID 'payoutFrequency' not found."); }
                        
                        const dailyReinvestmentRateInput = document.getElementById('dailyReinvestmentRate');
                        if (!dailyReinvestmentRateInput) { throw new Error("Element with ID 'dailyReinvestmentRate' not found."); }

                        const initialAmount = parseFloat(initialAmountComparisonInput.value);
                        const annualDirectRates = [
                            parseFloat(annualDirectRateYear1Input.value),
                            parseFloat(annualDirectRateYear2Input.value),
                            parseFloat(annualDirectRateYear3Input.value)
                        ];
                        const periodicRates = [
                            parseFloat(periodicRateYear1Input.value),
                            parseFloat(periodicRateYear2Input.value), // Corrected variable name
                            parseFloat(periodicRateYear3Input.value)  // Corrected variable name
                        ];
                        const payoutFrequencyScenario1 = payoutFrequencyScenario1Select.value;
                        const payoutFrequency = payoutFrequencySelect.value;
                        const dailyReinvestmentRate = parseFloat(dailyReinvestmentRateInput.value);

                        if (isNaN(initialAmount) || initialAmount <= 0 || 
                            annualDirectRates.some(isNaN) || periodicRates.some(isNaN) || isNaN(dailyReinvestmentRate)) {
                            throw new Error("ุงูุฑุฌุงุก ุฅุฏุฎุงู ุฃุฑูุงู ุตุญูุญุฉ ูุฌููุน ุญููู ุงูุดูุงุฏุงุช.");
                        }

                        // Scenario 1 Calculation: Simple interest on principal, paid out periodically, then reinvested daily.
                        let totalReinvestedEarningsScenario1 = 0;
                        const dailyReinvestmentRateFactor = (1 + dailyReinvestmentRate / 100 / 365);
                        const payoutsPerYearScenario1 = getPayoutPeriodsPerYear(payoutFrequencyScenario1);
                        const daysBetweenPayoutsScenario1 = 365 / payoutsPerYearScenario1;

                        for (let year = 0; year < 3; year++) {
                            const currentAnnualRate = annualDirectRates[year];
                            const annualSimpleInterest = initialAmount * (currentAnnualRate / 100);
                            const payoutAmountPerPeriod = annualSimpleInterest / payoutsPerYearScenario1;
                            
                            if (isNaN(payoutAmountPerPeriod) || !isFinite(payoutAmountPerPeriod)) {
                                throw new Error(`ุฎุทุฃ ูู ุญุณุงุจ ุงููุงุฆุฏุฉ ุงูุณูููุฉ ููุณููุงุฑูู ุงูุฃูู ูู ุงูุณูุฉ ${year + 1}.`);
                            }

                            for (let i = 0; i < payoutsPerYearScenario1; i++) {
                                const daysToThisPayout = (year * 365) + ((i + 1) * daysBetweenPayoutsScenario1);
                                const daysRemainingForCompounding = (3 * 365) - daysToThisPayout;
                                const actualDaysRemaining = Math.max(0, daysRemainingForCompounding);
                                
                                const futureValueOfPayout = payoutAmountPerPeriod * Math.pow(dailyReinvestmentRateFactor, actualDaysRemaining);
                                if (isNaN(futureValueOfPayout) || !isFinite(futureValueOfPayout)) {
                                    throw new Error(`ุฎุทุฃ ูู ุญุณุงุจ ุงููููุฉ ุงููุณุชูุจููุฉ ููุฏูุนุฉ ูู ุงูุณููุงุฑูู ุงูุฃููุ ุงูุณูุฉ ${year + 1}ุ ุงูุฏูุนุฉ ${i + 1}.`);
                                }
                                totalReinvestedEarningsScenario1 += futureValueOfPayout;
                            }
                        }
                        finalAmountScenario1Global = initialAmount + totalReinvestedEarningsScenario1;
                        const roiScenario1 = ((finalAmountScenario1Global - initialAmount) / initialAmount) * 100;
                        const cagrScenario1 = (Math.pow(finalAmountScenario1Global / initialAmount, 1/3) - 1) * 100;

                        // Scenario 2 Calculation: Simple interest on principal, paid out periodically, then reinvested daily.
                        let totalReinvestedEarningsScenario2 = 0;
                        const payoutsPerYearScenario2 = getPayoutPeriodsPerYear(payoutFrequency);
                        const daysBetweenPayoutsScenario2 = 365 / payoutsPerYearScenario2;

                        for (let year = 0; year < 3; year++) {
                            const annualPeriodicRate = periodicRates[year];
                            const annualSimpleInterestForScenario2 = initialAmount * (annualPeriodicRate / 100); 
                            const payoutThisPeriod = annualSimpleInterestForScenario2 / payoutsPerYearScenario2;
                            
                            if (isNaN(payoutThisPeriod) || !isFinite(payoutThisPeriod)) { // Corrected typo here
                                throw new Error(`ุฎุทุฃ ูู ุญุณุงุจ ุงููุงุฆุฏุฉ ุงูุณูููุฉ ููุณููุงุฑูู ุงูุซุงูู ูู ุงูุณูุฉ ${year + 1}.`);
                            }

                            for (let i = 0; i < payoutsPerYearScenario2; i++) {
                                const daysToThisPayout = (year * 365) + ((i + 1) * daysBetweenPayoutsScenario2);
                                const daysRemainingForCompounding = (3 * 365) - daysToThisPayout;
                                const actualDaysRemaining = Math.max(0, daysRemainingForCompounding);

                                const futureValueOfPayout = payoutThisPeriod * Math.pow(dailyReinvestmentRateFactor, actualDaysRemaining);
                                if (isNaN(futureValueOfPayout) || !isFinite(futureValueOfPayout)) {
                                    throw new Error(`ุฎุทุฃ ูู ุญุณุงุจ ุงููููุฉ ุงููุณุชูุจููุฉ ููุฏูุนุฉ ูู ุงูุณููุงุฑูู ุงูุซุงููุ ุงูุณูุฉ ${year + 1}ุ ุงูุฏูุนุฉ ${i + 1}.`);
                                }
                                totalReinvestedEarningsScenario2 += futureValueOfPayout;
                            }
                        }
                        finalAmountScenario2Global = initialAmount + totalReinvestedEarningsScenario2;

                        const roiScenario2 = ((finalAmountScenario2Global - initialAmount) / initialAmount) * 100;
                        const cagrScenario2 = (Math.pow(finalAmountScenario2Global / initialAmount, 1/3) - 1) * 100;

                        // Get Arabic frequency for Scenario 1
                        const arabicPayoutFrequencyScenario1 = translateFrequencyToArabic(payoutFrequencyScenario1);
                        const arabicPayoutFrequencyScenario2 = translateFrequencyToArabic(payoutFrequency);


                        let resultHtml = `
                            <p class="mb-2">ุงููุจูุบ ุงูุฃููู: ${new Intl.NumberFormat('ar-EG', { style: 'currency', currency: 'EGP' }).format(initialAmount)}</p>
                            <p class="mb-2"><strong>ุงูุนุงุฆุฏ ุจุนุฏ 3 ุณููุงุช (ุงูุณููุงุฑูู ุงูุฃูู - ูุงุฆุฏุฉ ุณูููุฉ ุชุตุฑู ${arabicPayoutFrequencyScenario1}):</strong></p>
                            <p class="text-lg font-bold highlight-yellow mb-2">${new Intl.NumberFormat('ar-EG', { style: 'currency', currency: 'EGP' }).format(finalAmountScenario1Global)}</p>
                            <p class="text-base mb-2">ROI: ${roiScenario1.toFixed(2)}%</p>
                            <p class="text-base mb-4">ูุนุฏู ุงูุนุงุฆุฏ ุงูุณููู ุงูููุงูุฆ (CAGR): ${cagrScenario1.toFixed(2)}%</p>

                            <p class="mb-2"><strong>ุงูุนุงุฆุฏ ุจุนุฏ 3 ุณููุงุช (ุงูุณููุงุฑูู ุงูุซุงูู - ูุงุฆุฏุฉ ุฏูุฑูุฉ ูุน ุฅุนุงุฏุฉ ุงุณุชุซูุงุฑ):</strong></p>
                            <p class="text-lg font-bold highlight-yellow mb-2">${new Intl.NumberFormat('ar-EG', { style: 'currency', currency: 'EGP' }).format(finalAmountScenario2Global)}</p>
                            <p class="text-base mb-2">ROI: ${roiScenario2.toFixed(2)}%</p>
                            <p class="text-base mb-4">ูุนุฏู ุงูุนุงุฆุฏ ุงูุณููู ุงูููุงูุฆ (CAGR): ${cagrScenario2.toFixed(2)}%</p>
                        `;

                        // Store all relevant data for loan calculation based on user's choice
                        scenario1CertData = { rates: annualDirectRates, payoutFrequency: payoutFrequencyScenario1 };
                        scenario2CertData = { rates: periodicRates, payoutFrequency: payoutFrequency };
                        
                        // Determine the best scenario between 1 and 2 (for display purposes only)
                        let bestScenarioText = '';
                        let bestFinalAmount = 0;

                        if (finalAmountScenario1Global > finalAmountScenario2Global) {
                            bestScenarioText = `ุงูุณููุงุฑูู ุงูุฃูู (ูุงุฆุฏุฉ ุณูููุฉ ุชุตุฑู ${arabicPayoutFrequencyScenario1})`;
                            bestFinalAmount = finalAmountScenario1Global;
                        } else if (finalAmountScenario2Global > finalAmountScenario1Global) {
                            bestScenarioText = `ุงูุณููุงุฑูู ุงูุซุงูู (ูุงุฆุฏุฉ ุฏูุฑูุฉ ุชุตุฑู ${arabicPayoutFrequencyScenario2} ูุน ุฅุนุงุฏุฉ ุงุณุชุซูุงุฑ)`;
                            bestFinalAmount = finalAmountScenario2Global;
                        } else {
                            bestScenarioText = 'ููุง ุงูุณููุงุฑููููู ูุชุณุงูููู ูู ุงูุนุงุฆุฏ';
                            bestFinalAmount = finalAmountScenario1Global;
                        }

                        resultHtml += `<p class="text-green-400 font-bold text-xl">ุฃูุถู ุณููุงุฑูู ุจูู ุงูุดูุงุฏุงุช: ${bestScenarioText}!</p>`;

                        certificateComparisonResultDiv.innerHTML = resultHtml;
                        console.log("Certificate comparison completed.");

                        // Show share button and set its data attributes
                        shareButton.classList.remove('hidden');
                        shareButton.dataset.bestScenarioText = bestScenarioText;
                        shareButton.dataset.finalAmount = new Intl.NumberFormat('ar-EG', { style: 'currency', currency: 'EGP' }).format(bestFinalAmount);


                    } catch (error) {
                        console.error("An error occurred during certificate comparison calculation:", error);
                        certificateComparisonResultDiv.innerHTML = `<p class="text-red-400">ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุณุงุจ ููุงุฑูุฉ ุงูุดูุงุฏุงุช: ${error.message}. ูุฑุฌู ูุฑุงุฌุนุฉ ุงููุฏุฎูุงุช ูุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.</p>`;
                        shareButton.classList.add('hidden'); // Hide share button on error
                    } finally {
                        comparisonLoadingSpinner.classList.add('hidden');
                    }
                });
                // END: Certificate Comparison Modal Logic

                // START: Loan Calculator Modal Logic
                const loanCalculatorModal = document.getElementById('loanCalculatorModal');
                const openLoanCalculatorModalButton = document.getElementById('openLoanCalculatorModal');
                const closeLoanCalculatorModalButton = document.getElementById('closeLoanCalculatorModalButton');
                const loanCalculatorLoadingSpinner = document.getElementById('loanCalculatorLoadingSpinner');
                const calculateLoanScenarioButton = document.getElementById('calculateLoanScenarioButton');
                const loanScenarioResultDiv = document.getElementById('loanScenarioResult');

                // Add null checks for these elements
                if (!loanCalculatorModal) { console.error("FATAL ERROR: Element with ID 'loanCalculatorModal' not found."); return; }
                if (!openLoanCalculatorModalButton) { console.error("FATAL ERROR: Element with ID 'openInvestmentAdviceModal' not found."); return; }
                if (!closeLoanCalculatorModalButton) { console.error("FATAL ERROR: Element with ID 'closeLoanCalculatorModalButton' not found."); return; }
                if (!loanCalculatorLoadingSpinner) { console.error("FATAL ERROR: Element with ID 'loanCalculatorLoadingSpinner' not found."); return; }
                if (!calculateLoanScenarioButton) { console.error("FATAL ERROR: Element with ID 'calculateLoanScenarioButton' not found."); return; }
                if (!loanScenarioResultDiv) { console.error("FATAL ERROR: Element with ID 'loanScenarioResultDiv' not found."); return; }

                // Elements within the loan calculator modal
                const initialAmountLoanInput = document.getElementById('initialAmountLoan');
                const loanCertTypeSelect = document.getElementById('loanCertType');
                const loanAnnualRateInput = document.getElementById('loanAnnualRate');
                const loanDailyReinvestmentRateInput = document.getElementById('loanDailyReinvestmentRate');

                if (!initialAmountLoanInput) { console.error("FATAL ERROR: Element with ID 'initialAmountLoan' not found."); return; }
                if (!loanCertTypeSelect) { console.error("FATAL ERROR: Element with ID 'loanCertType' not found."); return; }
                if (!loanAnnualRateInput) { console.error("FATAL ERROR: Element with ID 'loanAnnualRate' not found."); return; }
                if (!loanDailyReinvestmentRateInput) { console.error("FATAL ERROR: Element with ID 'loanDailyReinvestmentRate' not found."); return; }


                openLoanCalculatorModalButton.addEventListener('click', () => {
                    loanCalculatorModal.style.display = 'flex';
                    loanScenarioResultDiv.innerHTML = ''; // Clear previous results
                });

                closeLoanCalculatorModalButton.addEventListener('click', () => {
                    loanCalculatorModal.style.display = 'none';
                });

                window.addEventListener('click', (event) => {
                    if (event.target == loanCalculatorModal) {
                        loanCalculatorModal.style.display = 'none';
                    }
                });

                // Function to calculate Scenario 3 (Loan)
                calculateLoanScenarioButton.addEventListener('click', () => {
                    console.log("Calculate Loan Scenario button clicked.");
                    loanScenarioResultDiv.innerHTML = '';
                    loanCalculatorLoadingSpinner.classList.remove('hidden');

                    try {
                        const initialAmount = parseFloat(initialAmountLoanInput.value);
                        const loanAnnualRate = parseFloat(loanAnnualRateInput.value);
                        const dailyReinvestmentRate = parseFloat(loanDailyReinvestmentRateInput.value);
                        const loanCertType = loanCertTypeSelect.value; // Get selected certificate type for loan

                        if (isNaN(initialAmount) || initialAmount <= 0 || isNaN(loanAnnualRate) || isNaN(dailyReinvestmentRate)) {
                            throw new Error("ุงูุฑุฌุงุก ุฅุฏุฎุงู ุฃุฑูุงู ุตุญูุญุฉ ูุฌููุน ุญููู ุงููุฑุถ ูุฅุนุงุฏุฉ ุงูุงุณุชุซูุงุฑ.");
                        }

                        let certRatesForLoan = [];
                        let certPayoutFrequencyForLoan = '';

                        if (loanCertType === 'scenario1') {
                            certRatesForLoan = scenario1CertData.rates;
                            certPayoutFrequencyForLoan = scenario1CertData.payoutFrequency;
                        } else if (loanCertType === 'scenario2') {
                            certRatesForLoan = scenario2CertData.rates;
                            certPayoutFrequencyForLoan = scenario2CertData.payoutFrequency;
                        }

                        if (certRatesForLoan.length === 0 || certPayoutFrequencyForLoan === '') {
                            throw new Error("ูุฑุฌู ุญุณุงุจ ููุงุฑูุฉ ุงูุดูุงุฏุงุช ุฃููุงู ูู ุงููุงูุฐุฉ ุงูุฃุฎุฑู ูุชุญุฏูุฏ ููุน ุงูุดูุงุฏุฉ ูููุฑุถ.");
                        }

                        const certPeriodsPerYearForLoan = getPayoutPeriodsPerYear(certPayoutFrequencyForLoan);
                        
                        // Scenario 3 Calculation: Certificate with loan, periodic payouts, and reinvestment of net cash flow
                        let totalReinvestedSurplusesScenario3 = 0;
                        let totalUserContributionScenario3 = 0;
                        const loanPrincipal = initialAmount * 0.90; // 90% of certificate value
                        const loanTermMonths = 3 * 12; // 3 years fixed
                        const loanMonthlyRate = loanAnnualRate / 100 / 12;

                        let monthlyLoanInstallment = 0;
                        if (loanMonthlyRate > 0) {
                            monthlyLoanInstallment = (loanPrincipal * loanMonthlyRate) / (1 - Math.pow(1 + loanMonthlyRate, -loanTermMonths));
                        } else {
                            monthlyLoanInstallment = loanPrincipal / loanTermMonths;
                        }
                        
                        if (isNaN(monthlyLoanInstallment) || !isFinite(monthlyLoanInstallment)) {
                            throw new Error("ุฎุทุฃ ูู ุญุณุงุจ ูุณุท ุงููุฑุถ ุงูุดูุฑู. ูุฑุฌู ูุฑุงุฌุนุฉ ูุณุจุฉ ูุงุฆุฏุฉ ุงููุฑุถ.");
                        }
                        console.log(`Scenario 3 - Loan Principal: ${loanPrincipal.toFixed(2)}, Monthly Loan Rate: ${(loanMonthlyRate*100).toFixed(4)}%, Monthly Installment: ${monthlyLoanInstallment.toFixed(2)}`);
                        
                        const dailyReinvestmentRateFactor = (1 + dailyReinvestmentRate / 100 / 365);


                        // Monthly loop for 3 years (36 months)
                        for (let month = 0; month < loanTermMonths; month++) {
                            const currentYearIndex = Math.floor(month / 12);
                            // Ensure currentYearIndex does not exceed array bounds
                            if (currentYearIndex >= certRatesForLoan.length) {
                                console.warn(`Year index ${currentYearIndex} out of bounds for certRatesForLoan. Using last available rate.`);
                                // Fallback to the last available rate if year index is out of bounds
                                certRatesForLoan[currentYearIndex] = certRatesForLoan[certRatesForLoan.length - 1];
                            }
                            const currentAnnualCertRate = certRatesForLoan[currentYearIndex]; // Certificate rate from selected scenario

                            let periodicCertIncome = 0;
                            // Check if it's a payout period for the certificate
                            if (certPeriodsPerYearForLoan > 0 && (month % (12 / certPeriodsPerYearForLoan) === 0)) {
                                periodicCertIncome = initialAmount * (currentAnnualCertRate / 100) / certPeriodsPerYearForLoan;
                            }
                            if (isNaN(periodicCertIncome) || !isFinite(periodicCertIncome)) {
                                throw new Error(`ุฎุทุฃ ูู ุญุณุงุจ ุงูุนุงุฆุฏ ุงูุฏูุฑู ููุดูุงุฏุฉ ูู ุงูุณููุงุฑูู ุงูุซุงูุซุ ุงูุดูุฑ ${month + 1}.`);
                            }

                            const netCashFlowThisMonth = periodicCertIncome - monthlyLoanInstallment;

                            console.log(`Scenario 3 - Month ${month + 1}: Cert Income = ${periodicCertIncome.toFixed(2)}, Loan Installment = ${monthlyLoanInstallment.toFixed(2)}, Net Cash Flow = ${netCashFlowThisMonth.toFixed(2)}`);

                            if (netCashFlowThisMonth > 0) {
                                // Surplus: Reinvest this amount daily from this month until the end of 3 years
                                const daysPassed = (month + 1) * (365 / 12); // Approximate days passed until end of this month
                                const daysRemainingForCompounding = (3 * 365) - daysPassed;
                                const actualDaysRemaining = Math.max(0, daysRemainingForCompounding);
                                
                                const futureValueOfSurplus = netCashFlowThisMonth * Math.pow(dailyReinvestmentRateFactor, actualDaysRemaining);
                                if (isNaN(futureValueOfSurplus) || !isFinite(futureValueOfSurplus)) {
                                    throw new Error(`ุฎุทุฃ ูู ุญุณุงุจ ุงููููุฉ ุงููุณุชูุจููุฉ ูููุงุฆุถ ูู ุงูุณููุงุฑูู ุงูุซุงูุซุ ุงูุดูุฑ ${month + 1}.`);
                                }
                                totalReinvestedSurplusesScenario3 += futureValueOfSurplus;
                                console.log(`  Surplus Reinvested: Days Remaining = ${actualDaysRemaining.toFixed(0)}, FV of Surplus = ${futureValueOfSurplus.toFixed(2)}`);
                            } else {
                                // Deficit: User adds this amount from pocket
                                totalUserContributionScenario3 += Math.abs(netCashFlowThisMonth);
                                console.log(`  Deficit: User contributes ${Math.abs(netCashFlowThisMonth).toFixed(2)}`);
                            }
                        }

                        const finalAmountScenario3 = initialAmount + totalReinvestedSurplusesScenario3; // Certificate principal returned + reinvested surpluses
                        const totalInvestmentScenario3 = initialAmount + totalUserContributionScenario3; // Initial certificate + user's added money

                        if (totalInvestmentScenario3 <= 0) {
                            throw new Error("ุฅุฌูุงูู ุงูุงุณุชุซูุงุฑ ููุณููุงุฑูู ุงูุซุงูุซ ุบูุฑ ุตุงูุญ ููุญุณุงุจ (ูุฏ ูููู ุตูุฑ ุฃู ุฃูู).");
                        }

                        const roiScenario3 = ((finalAmountScenario3 - totalInvestmentScenario3) / totalInvestmentScenario3) * 100;
                        const cagrScenario3 = (Math.pow(finalAmountScenario3 / totalInvestmentScenario3, 1/3) - 1) * 100;
                        console.log("Scenario 3 Results:", { finalAmountScenario3: finalAmountScenario3.toFixed(2), totalUserContributionScenario3: totalUserContributionScenario3.toFixed(2), roiScenario3: roiScenario3.toFixed(2), cagrScenario3: cagrScenario3.toFixed(2) });

                        // Get Arabic frequency for the selected loan certificate type
                        const arabicLoanCertPayoutFrequency = translateFrequencyToArabic(certPayoutFrequencyForLoan);

                        let loanResultHtml = `
                            <p class="mb-2"><strong>ุงูุนุงุฆุฏ ุจุนุฏ 3 ุณููุงุช (ุงูุณููุงุฑูู ุงูุซุงูุซ - ุดูุงุฏุฉ ุจูุฑุถ ุจุถูุงู ุดูุงุฏุฉ ุชุตุฑู ${arabicLoanCertPayoutFrequency}):</strong></p>
                            <p class="text-lg font-bold highlight-yellow mb-2">${new Intl.NumberFormat('ar-EG', { style: 'currency', currency: 'EGP' }).format(finalAmountScenario3)}</p>
                            <p class="text-base mb-2">ุฅุฌูุงูู ูุณุงููุฉ ุงููุณุชุฎุฏู ุงูุฅุถุงููุฉ: ${new Intl.NumberFormat('ar-EG', { style: 'currency', currency: 'EGP' }).format(totalUserContributionScenario3.toFixed(2))}</p>
                            <p class="text-base mb-2">ROI: ${roiScenario3.toFixed(2)}%</p>
                            <p class="text-base mb-4">ูุนุฏู ุงูุนุงุฆุฏ ุงูุณููู ุงูููุงูุฆ (CAGR): ${cagrScenario3.toFixed(2)}%</p>
                        `;

                        // Provide advice on whether to take the loan
                        const maxFinalAmountOfCertificates = Math.max(finalAmountScenario1Global, finalAmountScenario2Global);
                        let loanAdvice = '';

                        // Compare the final value of scenario 3 against the best of scenario 1/2
                        if (finalAmountScenario3 > maxFinalAmountOfCertificates && totalUserContributionScenario3 <= (initialAmount * 0.05)) { // Small user contribution tolerance
                            loanAdvice = '<p class="text-green-400 font-bold text-xl">ูุตูุญุฉ: ุฃุฎุฐ ุงููุฑุถ ูู ูุฐุง ุงูุณููุงุฑูู ูุฏ ูููู ูููุฏุงูุ ุญูุซ ุฃุฏู ุฅูู ุนุงุฆุฏ ููุงุฆู ุฃุนูู ูุน ูุณุงููุฉ ุฅุถุงููุฉ ูุญุฏูุฏุฉ.</p>';
                        } else if (finalAmountScenario3 > maxFinalAmountOfCertificates && totalUserContributionScenario3 > (initialAmount * 0.05)) {
                            loanAdvice = '<p class="text-yellow-400 font-bold text-xl">ูุตูุญุฉ: ุฃุฎุฐ ุงููุฑุถ ูู ูุฐุง ุงูุณููุงุฑูู ุฃุฏู ุฅูู ุนุงุฆุฏ ููุงุฆู ุฃุนููุ ูููู ุชุทูุจ ูุณุงููุฉ ุฅุถุงููุฉ ูุจูุฑุฉ. ูุฑุฌู ูุฑุงุฌุนุฉ ูุฏุฑุชู ุนูู ุชุบุทูุฉ ูุฐู ุงููุณุงููุงุช.</p>';
                        }
                        else if (finalAmountScenario3 < maxFinalAmountOfCertificates) {
                            loanAdvice = '<p class="text-red-400 font-bold text-xl">ูุตูุญุฉ: ุฃุฎุฐ ุงููุฑุถ ูู ูุฐุง ุงูุณููุงุฑูู ุฃุฏู ุฅูู ุนุงุฆุฏ ููุงุฆู ุฃูู. ูุฏ ูุง ูููู ุงูุฎูุงุฑ ุงูุฃูุซู ูู.</p>';
                        } else {
                            loanAdvice = '<p class="text-gray-400 font-bold text-xl">ูุตูุญุฉ: ุงูุนุงุฆุฏ ูู ูุฐุง ุงูุณููุงุฑูู ูุฑูุจ ูู ุฃูุถู ุณููุงุฑูููุงุช ุงูุดูุงุฏุงุช ุงูุฃุฎุฑู. ูุฑุฌู ูุฑุงุฌุนุฉ ุงูุชูุงุตูู ูุงุชุฎุงุฐ ุงููุฑุงุฑ.</p>';
                        }

                        loanResultHtml += loanAdvice;
                        loanScenarioResultDiv.innerHTML = loanResultHtml;
                        console.log("Loan scenario calculation completed and advice displayed.");

                    } catch (error) {
                        console.error("An error occurred during loan scenario calculation:", error);
                        loanScenarioResultDiv.innerHTML = `<p class="text-red-400">ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุณุงุจ ูุถุน ุงููุฑุถ: ${error.message}. ูุฑุฌู ูุฑุงุฌุนุฉ ุงููุฏุฎูุงุช ูุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.</p>`;
                    } finally {
                        loanCalculatorLoadingSpinner.classList.add('hidden');
                    }
                });
                // END: Loan Calculator Modal Logic
            } catch (error) {
                console.error('Error fetching initial data:', error);
                loadingOverlay.innerHTML = `<p class="text-red-400">ูุดู ุชุญููู ุงูุจูุงูุงุช ุงูุฃูููุฉ: ${error.message}. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.</p>`;
            } finally {
                // Hide loading overlay and show content
                loadingOverlay.remove();
                if (mainContent) mainContent.style.display = 'block';
                if (header) header.style.display = 'block';
                if (footer) footer.style.display = 'block';
                if (floatingButtons) floatingButtons.style.display = 'flex';
            }
        };

        function shareResult() {
            const shareButton = document.getElementById('share-btn');
            const bestScenarioText = shareButton.dataset.bestScenarioText;
            const finalAmount = shareButton.dataset.finalAmount;
            const infographicUrl = window.location.href.split('#')[0]; // Get current URL without hash

            const shareText = `ููุฏ ููุช ุจุชุญููู ุนูุงุฆุฏ ุงูุดูุงุฏุงุช ุงูุงุณุชุซูุงุฑูุฉ! ${bestScenarioText} ูุญูู ${finalAmount} ุจุนุฏ 3 ุณููุงุช. ุงูุชุดู ุงููุฒูุฏ ุนูู: ${infographicUrl}`;

            if (navigator.share) {
                navigator.share({
                    title: 'ุชุญููู ุนูุงุฆุฏ ุงูุดูุงุฏุงุช ุงูุงุณุชุซูุงุฑูุฉ',
                    text: shareText,
                    url: infographicUrl
                }).then(() => {
                    console.log('Thanks for sharing!');
                }).catch(console.error);
            } else {
                const tempInput = document.createElement('textarea');
                tempInput.value = shareText;
                document.body.appendChild(tempInput);
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);

                const messageDiv = document.createElement('div');
                messageDiv.textContent = 'ุชู ูุณุฎ ุงูุฑุงุจุท ูุงููุชุงุฆุฌ ุฅูู ุงูุญุงูุธุฉ!';
                messageDiv.style.cssText = 'position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background-color: #06D6A0; color: #073B4C; padding: 10px 20px; border-radius: 5px; z-index: 1000;';
                document.body.appendChild(messageDiv);
                setTimeout(() => {
                    document.body.removeChild(messageDiv);
                }, 3000);
            }
        }
    </script>
    <!-- END: JavaScript Section -->
</body>
</html>
